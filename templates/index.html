[[extend 'layout.html']]

<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Recipe and Me</title>
   <style>
      [v-cloak] {
           display: none;
      }
   </style>
</head>

<div class="section mx-6" id="vue-target" v-cloak>
   <div class="container">
      <div class="level">
         <h1 class="title">Recipe and Me â€” Discover</h1>
         <div class="field has-addons">
            <p class="control has-icons-left">
               <input type="search" class="input" placeholder="Search..." v-model="query" @keyup="search"/>
               <span class="icon is-small is-left">
                  <i class="fa fa-search"></i>
               </span>
            </p>
            <div class="dropdown control is-right is-hoverable">
               <div class="dropdown-trigger">
                 <button class="button" aria-haspopup="true" aria-controls="dropdown-menu">
                   <span>Filter by Tags</span>
                   <span class="icon is-small">
                     <i class="fa fa-angle-down" aria-hidden="true"></i>
                   </span>
                 </button>
               </div>
               <div class="dropdown-menu" id="dropdown-menu" role="menu">
                 <div class="dropdown-content">
                  [[for tag in tags:]]
                   <div class="dropdown-item has-text-right">
                     <span class="tag is-rounded is-medium is-capitalized is-primary is-light">[[=tag.name]]</span>
                   </div>
                   [[pass]]
                 </div>
               </div>
             </div>
   
         </div>
      </div>

      <div class="tile is-ancestor is-flex-wrap-wrap">
         <div v-for="row in rows" class="tile is-parent is-4" >
            <div class="tile is-child card">
               <header class="card-header">
                  <p class="card-header-title is-centered">
                     {{row['name']}}
                  </p>
               </header>
               <div class="card-image">
               <figure class="image is-4by3">
                  <img src="https://bulma.io/images/placeholders/1280x960.png" alt="Placeholder image">
               </figure>
               </div>
               <div class="card-content">
                  <div class="content">
                     <div class="tags">
                        <span class="tag is-rounded is-medium is-capitalized" v-for="ingredient in row['ingredients_rows']">
                           {{ingredient}}
                        </span>
                        <span class="tag is-rounded is-medium is-capitalized is-primary is-light" v-for="tag in row['tag_rows']">
                           {{tag}}
                        </span>
                     </div>
                  </div>
               </div>
               
                <footer class="card-footer">
                   <button class="button is-primary is-fullwidth"  @click="set_modal(true , row._idx)">View</button>
                   <div v-if="modals[row._idx]" class="modal is-active">
                        <div class="modal-background"></div>
                            <div class="modal-content">
                                 <p class="image is-4by3">
                                     <img src="https://bulma.io/images/placeholders/1280x960.png" alt="">
                                 </p>
                            </div>
                            <button class="modal-close is-large"  aria-label="close" @click="set_modal(false, row._idx)"></button>
                    </div>
               </footer>
               
            </div>
         </div>
      </div>

      <table class="table is-striped is-fullwidth has-text-left">
         <tr>
            <th>Recipe Name</th>
            <th>Steps</th>
            <th>Cook Time</th>
            <th>Ingredients</th>
            <th>Tags</th>
         </tr>
         [[for row in rows:]]
         <tr>
            <td>[[=row['name'] ]]</td>
            <td>[[=row['steps'] ]]</td>
            <td>[[=row['cook_time'] ]]</td>
            <td>[[=row['ingredients'] ]]</td>
            <td>[[=row['tags'] ]]</td>
         </tr>
         [[pass]]
      </table>

   </div>
</div>
[[block page_scripts]]
<!-- Loads the index-specific js for Vue -->
<script>
  let search_url = "[[=XML(search_url)]]";
  let load_shared_recipes_url = "[[=XML(load_shared_recipes_url)]]"
</script>
<script src="js/index.js"></script>
[[end]]
</html>